<!DOCTYPE html>
<html>
<head>
    <title>SUDAN CONTROL PRO</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0f0f0f; color: #e0e0e0; text-align: center; padding: 20px; }
        .container { max-width: 600px; margin: auto; background: #1a1a1a; padding: 20px; border-radius: 15px; border: 1px solid #333; }
        .btn { padding: 15px 30px; font-size: 18px; cursor: pointer; border-radius: 8px; border: none; font-weight: bold; transition: 0.3s; width: 100%; margin-top: 10px; }
        .on { background: #2ecc71; color: white; }
        .off { background: #e74c3c; color: white; }
        .data-box { margin-top: 30px; text-align: left; background: #252525; padding: 15px; border-radius: 10px; border-left: 5px solid #3498db; }
        .data-item { border-bottom: 1px solid #444; padding: 10px 0; font-family: monospace; }
        .label { color: #3498db; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>Project Control Center</h2>
    
    <div style="margin: 20px 0;">
        <div id="statusText" style="font-size: 22px; margin-bottom: 10px;">Status: Connecting...</div>
        <button id="mainBtn" class="btn" onclick="toggleControl()">Loading...</button>
    </div>

    <div class="data-box">
        <h3>Live Logs (MyActivities)</h3>
        <div id="activitiesList">No data yet...</div>
    </div>

    <div class="data-box" style="border-left-color: #f1c40f;">
        <h3>Incoming Cash (Cash)</h3>
        <div id="cashList">Waiting for transactions...</div>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyAoAfx2voGpTuXh2I-V2XpgOyn5kAM6YIA",
        authDomain: "sudancontrol-c5050.firebaseapp.com",
        databaseURL: "https://sudancontrol-c5050-default-rtdb.firebaseio.com",
        projectId: "sudancontrol-c5050",
        storageBucket: "sudancontrol-c5050.appspot.com"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let currentState = false;

    // Control Logic
    db.ref('control/status').on('value', (snapshot) => {
        currentState = snapshot.val() === "true" || snapshot.val() === true;
        document.getElementById('statusText').innerText = "Status: " + (currentState ? "ACTIVE" : "OFF");
        document.getElementById('mainBtn').innerText = currentState ? "DEACTIVATE SYSTEM" : "ACTIVATE SYSTEM";
        document.getElementById('mainBtn').className = "btn " + (currentState ? "off" : "on");
    });

    function toggleControl() {
        db.ref('control/status').set(currentState ? "false" : "true");
    }

    // Monitoring Activities
    db.ref('MyActivities').limitToLast(5).on('value', (snapshot) => {
        const list = document.getElementById('activitiesList');
        list.innerHTML = "";
        snapshot.forEach((child) => {
            list.innerHTML += `<div class="data-item"><span class="label">></span> ${child.val()}</div>`;
        });
    });

    // Monitoring Cash
    db.ref('Cash').limitToLast(5).on('value', (snapshot) => {
        const list = document.getElementById('cashList');
        list.innerHTML = "";
        snapshot.forEach((child) => {
            list.innerHTML += `<div class="data-item"><span class="label">AMT:</span> ${child.val()}</div>`;
        });
    });
</script>

</body>
</html>
